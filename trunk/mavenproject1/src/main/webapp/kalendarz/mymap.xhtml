<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>        
        <script src="http://maps.google.com/maps/api/js?sensor=false&amp;v=3.4" type="text/javascript"></script>
    </h:head>

    <ui:composition template="/templates/maintemplate.xhtml">
        <ui:define name="body"> 
                    <h:panelGrid columns="1" cellpadding="0" >           
                        <p:gmap widgetVar="w_gmap" center="36.890257,30.707417" zoom="13" type="HYBRID" style="width:1000px;height:800px" model="#{eventList.simpleModel}" >
                            <p:ajax event="overlaySelect" listener="#{eventList.onMarkerSelect}" />

                            <p:gmapInfoWindow id="infoWindow">
                                <p:outputPanel style="text-align: center; display: block; margin: auto">
                                    <p:panelGrid>
                                        <p:row>
                                            <p:column><h:outputText value="#{eventList.marker.data.title}"/></p:column>
                                            <p:column>Ocena xxx</p:column>
                                        </p:row>
                                        <p:row>
                                            <p:column colspan="2">
                                                <h:outputText value="#{eventList.marker.data.opis}" />            
                                            </p:column>
                                        </p:row>
                                    </p:panelGrid>    
                                </p:outputPanel>
                            </p:gmapInfoWindow>
                        </p:gmap> 
                        
                        
<script type="text/javascript">
    if (navigator.geolocation) {
        checkGeolocationByHTML5();
    } else {
        checkGeolocationByLoaderAPI(); // HTML5 not supported! Fall back to Loader API.
    }

    function checkGeolocationByHTML5() {
        navigator.geolocation.getCurrentPosition(function(position) {
            setMapCenter(position.coords.latitude, position.coords.longitude);
        }, function() {
            checkGeolocationByLoaderAPI(); // Error! Fall back to Loader API.
        });
    }

    function checkGeolocationByLoaderAPI() {
        if (google.loader.ClientLocation) {
            setMapCenter(google.loader.ClientLocation.latitude, google.loader.ClientLocation.longitude);
        } else {
            // Unsupported! Show error/warning?
        }
    }

    function setMapCenter(latitude, longitude) {
        PF('w_gmap').getMap().setCenter(new google.maps.LatLng(latitude, longitude));
    }
</script>
                        
                    </h:panelGrid>



        </ui:define>
    </ui:composition>
</html>